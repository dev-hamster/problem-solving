# 괄호의 값

## 문제

1. ‘()’ 인 괄호열의 값은 2이다.
2. ‘[]’ 인 괄호열의 값은 3이다.
3. ‘(X)’ 의 괄호값은 2×값(X) 으로 계산된다.
4. ‘[X]’ 의 괄호값은 3×값(X) 으로 계산된다.
5. 올바른 괄호열 X와 Y가 결합된 XY의 괄호값은 값(XY)= 값(X)+값(Y) 로 계산된다.
예를 들어 ‘(()[[]])([])’ 의 괄호값을 구해보자. ‘()[[]]’ 의 괄호값이 2 + 3×3=11 이므로 ‘(()[[]])’의 괄호값은 2×11=22 이다. 그리고 ‘([])’의 값은 2×3=6 이므로 전체 괄호열의 값은 22 + 6 = 28 이다.

위 조건에 따라 괄호의 값을 계산하자.

## 접근
스택과 분배법칙을 활용한다.

`(()[[]])([])`는 분배법칙을 따라 $2*(2+3*3)+2*3 = 2*2+2*3*3+2*3$ 이다.

`(()[[]])`예제에서 먼저 간단하게 로직을 살펴보자. 여는 괄호가 나올 때는 누적값에 2또는 3을 곱한다. 닫는 괄호가 나오면 ans에 누적값을 더해주고 누적값을 이전 값으로 되돌리기 위해 2또는 3으로 나눈다.
- `((`는 여는 괄호가 두번 나와서 2*2를 해준다. `acc`는 4이다. 
- `(()` 닫는 괄호가 나와 `ans`에 `acc`를 더해주고 다시 `acc`는 2를 나눈다. `acc`는 2이다.
- `([[`는 여는 괄호가 두번 나와 `acc(2)*3*3` 을 해준다. `acc`는 18이다.
- `([[]`는 닫는 괄호가 나와 `ans`에 `acc`를 더해준다.
  
이때 닫는 괄호가 나와 ans에 누적값을 더할 때 자신의 직전의 괄호와 짝이 맞는지 확인 후 ans를 더해야한다.

## 코드 
```python
import sys
input = sys.stdin.readline

arr = input()
stack = []
ans = 0
acc = 1
for i in range(len(arr)):
    if arr[i] == '(':
        acc *= 2
        stack.append(arr[i])
    elif arr[i] == '[':
        acc *= 3
        stack.append(arr[i])
    elif arr[i] == ')':
        # 괄호가 올바른지 판별
        if not stack or stack[-1] != '(':
            ans = 0
            break
        # 바로 직전의 괄호와 짝이 맞으면 ans에 더한다. 
        if arr[i-1] == '(':
            ans += acc
        stack.pop()
        # acc를 나누어서 이전의 값으로 되돌린다.
        acc //= 2
    elif arr[i] == ']':
        if not stack or stack[-1] != '[':
            ans = 0
            break
        if arr[i-1] == '[':
            ans += acc
        stack.pop()
        acc //= 3

if stack:
    ans = 0
print(ans)
```